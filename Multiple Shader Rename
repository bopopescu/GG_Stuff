from maya import cmds, mel
### load vray
cmds.loadPlugin('vrayformaya', quiet=True)
### autoload vray
cmds.pluginInfo('vrayformaya', edit=True, autoload=True)
### change render drop down
cmds.setAttr('defaultRenderGlobals.ren', 'vray', type='string')

### change to vray shader
shader = cmds.ls(type = ['blinn','phong'], l = True)
cmds.select(shader)
mel.eval('maya2VRay()')
    
### select vray shader, change shader attr, strip front and back letter.
vrayshader = cmds.ls(type = ['VRayMtl'], l = True)  
for x in(vrayshader):
    cmds.setAttr(x+'.reflectionGlossiness', 1)
    cmds.setAttr(x+'.bumpMult', 1)
    cmds.setAttr(x+'.diffuseColorAmount', 1)
    cmds.rename(x, x.strip('KAZ_P_'+'VRAY'))

### change first letter to uppercase. 
vrayshader = cmds.ls(type = ['VRayMtl'], l = True)       
for x in(vrayshader):
    cmds.rename(x, x.capitalize())

### texture input gamma 
texture_file = cmds.ls(type = ['file'], l = True)
for x in (texture_file):
     cmds.vray(x, "addAttributesFromGroup", x, 'vray_file_gamma', 1)

### change bump to linear sRGB
bump_file = cmds.ls('*bump*',type = ['file'], l = True)
for x in (bump_file):
    cmds.setAttr("%s.colorProfile"%(x), 2)

### camera
mel.eval('camera -centerOfInterest 5 -focalLength 35 -lensSqueezeRatio 1 -cameraScale 1 -horizontalFilmAperture 1.41732 -horizontalFilmOffset 0 -verticalFilmAperture 0.94488 -verticalFilmOffset 0 -filmFit Fill -overscan 1 -motionBlur 0 -shutterAngle 144 -nearClipPlane 0.1 -farClipPlane 10000 -orthographic 0 -orthographicWidth 30 -panZoomEnabled 0 -horizontalPan 0 -verticalPan 0 -zoom 1; objectMoveCommand; cameraMakeNode 1 "";')
mel.eval('camera -e -displayFilmGate off -displayResolution on -overscan 1.3 camera1;')
mel.eval('lookThroughModelPanel camera1 modelPanel4;')
mel.eval('vray addAttributesFromGroup |camera1|cameraShape1 vray_cameraPhysical 1;')
mel.eval('setAttr "cameraShape1.vrayCameraPhysicalOn" 1;')
mel.eval('setAttr "cameraShape1.vrayCameraPhysicalFNumber" 2.8;')
mel.eval('setAttr "cameraShape1.vrayCameraPhysicalShutterSpeed" 100;')

### vraylightdome
mel.eval('select -r `shadingNode -asLight VRayLightDomeShape`')
mel.eval('setAttr "VRayLightDomeShape1.useDomeTex" 1;')
mel.eval('setAttr "VRayLightDomeShape1.intensityMult" 5;')
mel.eval('setAttr "VRayLightDomeShape1.domeSpherical" 1;')
cmds.defaultNavigation(createNew=True, destination='VRayLightDomeShape1.domeTex')
cmds.warning("insert hdri image to dome tex")

### 
grp = cmds.ls('*GRP*')
mel.eval('vray objectProperties add_single VRayDisplacement')
mel.eval('vray addAttributesFromGroup vrayDisplacement vray_opensubdiv 1;')
mel.eval('setAttr "vrayDisplacement.vrayOsdSubdivDepth" 2;')
mel.eval('')
mel.eval('')

### add passes 
mel.eval('vrayAddRenderElement rawGiChannel;')
mel.eval('vrayAddRenderElement rawLightChannel;')
mel.eval('vrayAddRenderElement rawReflectionChannel;')
mel.eval('vrayAddRenderElement sampleRateChannel;')
